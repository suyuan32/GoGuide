import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,o as n,d as i}from"./app-CeGilRH-.js";const l={},e=i(`<h2 id="what-is-a-closure" tabindex="-1"><a class="header-anchor" href="#what-is-a-closure"><span>What Is a Closure?</span></a></h2><div class="hint-container info"><p class="hint-container-title">What Is a Closure?</p><p>A closure is an entity composed of a function and the associated referencing environment. In simple terms, a closure is a function that references variables outside its own scope. The lifetime of this function can extend beyond the scope in which it was created.</p><p>Example</p><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="shiki shiki-themes github-light one-dark-pro vp-code" style="background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">package</span><span style="color:#6F42C1;--shiki-dark:#E5C07B;"> main</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">import</span><span style="color:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="color:#6F42C1;--shiki-dark:#98C379;">fmt</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">func</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;"> main</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E06C75;">	count</span><span style="color:#D73A49;--shiki-dark:#E5C07B;"> :=</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> func</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="color:#D73A49;--shiki-dark:#C678DD;">func</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="color:#D73A49;--shiki-dark:#C678DD;">int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E06C75;">		i</span><span style="color:#D73A49;--shiki-dark:#E5C07B;"> :=</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"> // Initialize a local variable within the function</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">		return</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> func</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="color:#D73A49;--shiki-dark:#C678DD;">int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E06C75;">			i</span><span style="color:#D73A49;--shiki-dark:#56B6C2;">++</span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"> // Increment the local variable</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">			return</span><span style="color:#24292E;--shiki-dark:#E06C75;"> i</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">	}()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E06C75;">	fmt</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Println</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;">count</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E06C75;">	fmt</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Println</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;">count</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;">// Output</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;">// 1</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;">// 2</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Notice that <code>i</code> is a local variable within the <code>count</code> function. Executing the function twice might lead one to expect the output to be <code>1</code> both times. However, the actual output is <code>1</code> followed by <code>2</code>. The reason is that when assigning the closure to a variable (<code>count</code>), it retains a pointer to <code>i</code>. As a result, <code>i</code> is preserved beyond the function&#39;s execution due to escape analysis. <strong>If the function is not assigned to a variable, executing it multiple times will yield consistent results.</strong></p></div><h2 id="use-cases" tabindex="-1"><a class="header-anchor" href="#use-cases"><span>Use Cases</span></a></h2><h3 id="middleware" tabindex="-1"><a class="header-anchor" href="#middleware"><span>Middleware</span></a></h3><p>When defining web middleware, we often encounter code like the following:</p><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="shiki shiki-themes github-light one-dark-pro vp-code" style="background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">func</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;"> makeHandler</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#E36209;--shiki-dark:#E06C75;font-style:inherit;--shiki-dark-font-style:italic;">fn</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> func</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#6F42C1;--shiki-dark:#E5C07B;">http</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="color:#6F42C1;--shiki-dark:#E5C07B;">ResponseWriter</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#D73A49;--shiki-dark:#C678DD;">*</span><span style="color:#6F42C1;--shiki-dark:#E5C07B;">http</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="color:#6F42C1;--shiki-dark:#E5C07B;">Request</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#D73A49;--shiki-dark:#C678DD;">string</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">)) </span><span style="color:#6F42C1;--shiki-dark:#E5C07B;">http</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="color:#6F42C1;--shiki-dark:#E5C07B;">HandlerFunc</span><span style="color:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> func</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#E36209;--shiki-dark:#E06C75;font-style:inherit;--shiki-dark-font-style:italic;">w</span><span style="color:#6F42C1;--shiki-dark:#E5C07B;"> http</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="color:#6F42C1;--shiki-dark:#E5C07B;">ResponseWriter</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#E36209;--shiki-dark:#E06C75;font-style:inherit;--shiki-dark-font-style:italic;">r</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> *</span><span style="color:#6F42C1;--shiki-dark:#E5C07B;">http</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="color:#6F42C1;--shiki-dark:#E5C07B;">Request</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E06C75;">        m</span><span style="color:#D73A49;--shiki-dark:#E5C07B;"> :=</span><span style="color:#24292E;--shiki-dark:#E06C75;"> validPath</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;">FindStringSubmatch</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#24292E;--shiki-dark:#E06C75;">r</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="color:#24292E;--shiki-dark:#E06C75;">URL</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="color:#24292E;--shiki-dark:#E06C75;">Path</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">        if</span><span style="color:#24292E;--shiki-dark:#E06C75;"> m</span><span style="color:#D73A49;--shiki-dark:#56B6C2;"> ==</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> nil</span><span style="color:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E06C75;">            http</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;">NotFound</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#24292E;--shiki-dark:#E06C75;">w</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#24292E;--shiki-dark:#E06C75;">r</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">            return</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">        fn</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#24292E;--shiki-dark:#E06C75;">w</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#24292E;--shiki-dark:#E06C75;">r</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#24292E;--shiki-dark:#E06C75;">m</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="color:#005CC5;--shiki-dark:#D19A66;">2</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">]) </span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;">// If no issues, continue executing fn</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In this example, we return an <code>http.HandlerFunc</code> that calls the <code>fn</code> function. This allows us to achieve chainable operationsâ€”executing middleware code while still continuing with the main function.</p><h2 id="state-sharing" tabindex="-1"><a class="header-anchor" href="#state-sharing"><span>State Sharing</span></a></h2><p>Closures can be used to share state across multiple invocations of a function. A common example is an iterator:</p><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="shiki shiki-themes github-light one-dark-pro vp-code" style="background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">package</span><span style="color:#6F42C1;--shiki-dark:#E5C07B;"> main</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">import</span><span style="color:#032F62;--shiki-dark:#98C379;"> &quot;</span><span style="color:#6F42C1;--shiki-dark:#98C379;">fmt</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">func</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;"> main</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E06C75;">	num</span><span style="color:#D73A49;--shiki-dark:#E5C07B;"> :=</span><span style="color:#24292E;--shiki-dark:#ABB2BF;"> []</span><span style="color:#D73A49;--shiki-dark:#C678DD;">int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">{</span><span style="color:#005CC5;--shiki-dark:#D19A66;">1</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#005CC5;--shiki-dark:#D19A66;">2</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#005CC5;--shiki-dark:#D19A66;">3</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#005CC5;--shiki-dark:#D19A66;">4</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E06C75;">	iterator</span><span style="color:#D73A49;--shiki-dark:#E5C07B;"> :=</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> func</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#E36209;--shiki-dark:#E06C75;font-style:inherit;--shiki-dark-font-style:italic;">arr</span><span style="color:#24292E;--shiki-dark:#ABB2BF;"> []</span><span style="color:#D73A49;--shiki-dark:#C678DD;">int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="color:#D73A49;--shiki-dark:#C678DD;">func</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">([]</span><span style="color:#D73A49;--shiki-dark:#C678DD;">int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">) (</span><span style="color:#D73A49;--shiki-dark:#C678DD;">int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#D73A49;--shiki-dark:#C678DD;">bool</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E06C75;">		i</span><span style="color:#D73A49;--shiki-dark:#E5C07B;"> :=</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> -</span><span style="color:#005CC5;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">		return</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> func</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#E36209;--shiki-dark:#E06C75;font-style:inherit;--shiki-dark-font-style:italic;">arr</span><span style="color:#24292E;--shiki-dark:#ABB2BF;"> []</span><span style="color:#D73A49;--shiki-dark:#C678DD;">int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">) (</span><span style="color:#D73A49;--shiki-dark:#C678DD;">int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#D73A49;--shiki-dark:#C678DD;">bool</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E06C75;">			i</span><span style="color:#D73A49;--shiki-dark:#56B6C2;">++</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">			if</span><span style="color:#24292E;--shiki-dark:#E06C75;"> i</span><span style="color:#D73A49;--shiki-dark:#56B6C2;"> &lt;</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;"> len</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#24292E;--shiki-dark:#E06C75;">arr</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">				return</span><span style="color:#24292E;--shiki-dark:#E06C75;"> arr</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="color:#24292E;--shiki-dark:#E06C75;">i</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">], </span><span style="color:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">			return</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#005CC5;--shiki-dark:#D19A66;">false</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E06C75;">	iter</span><span style="color:#D73A49;--shiki-dark:#E5C07B;"> :=</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;"> iterator</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#24292E;--shiki-dark:#E06C75;">num</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">	for</span><span style="color:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E06C75;">		value</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#24292E;--shiki-dark:#E06C75;">ok</span><span style="color:#D73A49;--shiki-dark:#E5C07B;"> :=</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;"> iter</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#24292E;--shiki-dark:#E06C75;">num</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">		if</span><span style="color:#D73A49;--shiki-dark:#56B6C2;"> !</span><span style="color:#24292E;--shiki-dark:#E06C75;">ok</span><span style="color:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">			return</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E06C75;">		fmt</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Println</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#24292E;--shiki-dark:#E06C75;">value</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;">// Output</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;">// 1</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;">// 2</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;">// 3</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;">// 4</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="callback-functions" tabindex="-1"><a class="header-anchor" href="#callback-functions"><span>Callback Functions</span></a></h2><p>We can also pass callback functions as parameters:</p><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="shiki shiki-themes github-light one-dark-pro vp-code" style="background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">func</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;"> GetData</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#E36209;--shiki-dark:#E06C75;font-style:inherit;--shiki-dark-font-style:italic;">data</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#E36209;--shiki-dark:#E06C75;font-style:inherit;--shiki-dark-font-style:italic;">callback</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> func</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#D73A49;--shiki-dark:#C678DD;">int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">)) {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">	go</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> func</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E06C75;">		result</span><span style="color:#D73A49;--shiki-dark:#E5C07B;"> :=</span><span style="color:#24292E;--shiki-dark:#E06C75;"> data</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> +</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 2</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">		callback</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#24292E;--shiki-dark:#E06C75;">result</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">	}()</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In the above example, after passing in <code>data</code>, the <code>callback</code> can access <code>result</code> for additional callback operations.</p><h2 id="function-factories" tabindex="-1"><a class="header-anchor" href="#function-factories"><span>Function Factories</span></a></h2><p>Closures allow us to create function factories by returning functions based on input parameters:</p><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="shiki shiki-themes github-light one-dark-pro vp-code" style="background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">func</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;"> CalculationFactory</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#E36209;--shiki-dark:#E06C75;font-style:inherit;--shiki-dark-font-style:italic;">operation</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> string</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="color:#D73A49;--shiki-dark:#C678DD;">func</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#D73A49;--shiki-dark:#C678DD;">int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#D73A49;--shiki-dark:#C678DD;">int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="color:#D73A49;--shiki-dark:#C678DD;">int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">	switch</span><span style="color:#24292E;--shiki-dark:#E06C75;"> operation</span><span style="color:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">	case</span><span style="color:#032F62;--shiki-dark:#98C379;"> &quot;add&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">		return</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> func</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#E36209;--shiki-dark:#E06C75;font-style:inherit;--shiki-dark-font-style:italic;">a</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#E36209;--shiki-dark:#E06C75;font-style:inherit;--shiki-dark-font-style:italic;">b</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="color:#D73A49;--shiki-dark:#C678DD;">int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">			return</span><span style="color:#24292E;--shiki-dark:#E06C75;"> a</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> +</span><span style="color:#24292E;--shiki-dark:#E06C75;"> b</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">	case</span><span style="color:#032F62;--shiki-dark:#98C379;"> &quot;subtract&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">		return</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> func</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#E36209;--shiki-dark:#E06C75;font-style:inherit;--shiki-dark-font-style:italic;">a</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#E36209;--shiki-dark:#E06C75;font-style:inherit;--shiki-dark-font-style:italic;">b</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="color:#D73A49;--shiki-dark:#C678DD;">int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">			return</span><span style="color:#24292E;--shiki-dark:#E06C75;"> a</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> -</span><span style="color:#24292E;--shiki-dark:#E06C75;"> b</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">	case</span><span style="color:#032F62;--shiki-dark:#98C379;"> &quot;multiply&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">		return</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> func</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#E36209;--shiki-dark:#E06C75;font-style:inherit;--shiki-dark-font-style:italic;">a</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#E36209;--shiki-dark:#E06C75;font-style:inherit;--shiki-dark-font-style:italic;">b</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="color:#D73A49;--shiki-dark:#C678DD;">int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">			return</span><span style="color:#24292E;--shiki-dark:#E06C75;"> a</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> *</span><span style="color:#24292E;--shiki-dark:#E06C75;"> b</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">	case</span><span style="color:#032F62;--shiki-dark:#98C379;"> &quot;divide&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">		return</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> func</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#E36209;--shiki-dark:#E06C75;font-style:inherit;--shiki-dark-font-style:italic;">a</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="color:#E36209;--shiki-dark:#E06C75;font-style:inherit;--shiki-dark-font-style:italic;">b</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="color:#D73A49;--shiki-dark:#C678DD;">int</span><span style="color:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">			if</span><span style="color:#24292E;--shiki-dark:#E06C75;"> b</span><span style="color:#D73A49;--shiki-dark:#56B6C2;"> !=</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="color:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">				return</span><span style="color:#24292E;--shiki-dark:#E06C75;"> a</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> /</span><span style="color:#24292E;--shiki-dark:#E06C75;"> b</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">			return</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">	default</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#C678DD;">		return</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> nil</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>By passing in <code>&quot;add&quot;</code>, you can obtain an addition function, and by passing in <code>&quot;divide&quot;</code>, you can obtain a division function.</p>`,18),r=[e];function o(t,p){return n(),a("div",null,r)}const k=s(l,[["render",o],["__file","50-closure.html.vue"]]),h=JSON.parse(`{"path":"/en/guide/concepts/golang/50-closure.html","title":"Closure","lang":"en-US","frontmatter":{"order":50,"title":"Closure","icon":"line-md:sun-rising-twotone-loop","head":[["meta",{"name":"keywords","content":"Go, Golang, closure, function factory, iterator"}],["link",{"rel":"alternate","hreflang":"zh-cn","href":"https://goguide.ryansu.tech/guide/concepts/golang/50-closure.html"}],["meta",{"property":"og:url","content":"https://goguide.ryansu.tech/en/guide/concepts/golang/50-closure.html"}],["meta",{"property":"og:site_name","content":"Go Guide"}],["meta",{"property":"og:title","content":"Closure"}],["meta",{"property":"og:description","content":"What Is a Closure? What Is a Closure? A closure is an entity composed of a function and the associated referencing environment. In simple terms, a closure is a function that ref..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:locale:alternate","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-21T12:50:27.000Z"}],["meta",{"property":"article:author","content":"Go Guide"}],["meta",{"property":"article:modified_time","content":"2024-05-21T12:50:27.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Closure\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-05-21T12:50:27.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Go Guide\\",\\"url\\":\\"https://github.com/suyuan32\\"}]}"]],"description":"What Is a Closure? What Is a Closure? A closure is an entity composed of a function and the associated referencing environment. In simple terms, a closure is a function that ref..."},"headers":[{"level":2,"title":"What Is a Closure?","slug":"what-is-a-closure","link":"#what-is-a-closure","children":[]},{"level":2,"title":"Use Cases","slug":"use-cases","link":"#use-cases","children":[{"level":3,"title":"Middleware","slug":"middleware","link":"#middleware","children":[]}]},{"level":2,"title":"State Sharing","slug":"state-sharing","link":"#state-sharing","children":[]},{"level":2,"title":"Callback Functions","slug":"callback-functions","link":"#callback-functions","children":[]},{"level":2,"title":"Function Factories","slug":"function-factories","link":"#function-factories","children":[]}],"git":{"createdTime":1716295827000,"updatedTime":1716295827000,"contributors":[{"name":"Ryan Su","email":"yuansu.china.work@gmail.com","commits":1}]},"readingTime":{"minutes":1.71,"words":514},"filePathRelative":"en/guide/concepts/golang/50-closure.md","localizedDate":"May 21, 2024","autoDesc":true,"excerpt":"<h2>What Is a Closure?</h2>\\n<div class=\\"hint-container info\\">\\n<p class=\\"hint-container-title\\">What Is a Closure?</p>\\n<p>A closure is an entity composed of a function and the associated referencing environment. In simple terms, a closure is a function that references variables outside its own scope. The lifetime of this function can extend beyond the scope in which it was created.</p>\\n<p>Example</p>\\n<div class=\\"language-go line-numbers-mode\\" data-ext=\\"go\\" data-title=\\"go\\"><pre class=\\"shiki shiki-themes github-light one-dark-pro vp-code\\" style=\\"background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf\\" tabindex=\\"0\\"><code><span class=\\"line\\"><span style=\\"color:#D73A49;--shiki-dark:#C678DD\\">package</span><span style=\\"color:#6F42C1;--shiki-dark:#E5C07B\\"> main</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#D73A49;--shiki-dark:#C678DD\\">import</span><span style=\\"color:#032F62;--shiki-dark:#98C379\\"> \\"</span><span style=\\"color:#6F42C1;--shiki-dark:#98C379\\">fmt</span><span style=\\"color:#032F62;--shiki-dark:#98C379\\">\\"</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#D73A49;--shiki-dark:#C678DD\\">func</span><span style=\\"color:#6F42C1;--shiki-dark:#61AFEF\\"> main</span><span style=\\"color:#24292E;--shiki-dark:#ABB2BF\\">() {</span></span>\\n<span class=\\"line\\"><span style=\\"color:#24292E;--shiki-dark:#E06C75\\">\\tcount</span><span style=\\"color:#D73A49;--shiki-dark:#E5C07B\\"> :=</span><span style=\\"color:#D73A49;--shiki-dark:#C678DD\\"> func</span><span style=\\"color:#24292E;--shiki-dark:#ABB2BF\\">() </span><span style=\\"color:#D73A49;--shiki-dark:#C678DD\\">func</span><span style=\\"color:#24292E;--shiki-dark:#ABB2BF\\">() </span><span style=\\"color:#D73A49;--shiki-dark:#C678DD\\">int</span><span style=\\"color:#24292E;--shiki-dark:#ABB2BF\\"> {</span></span>\\n<span class=\\"line\\"><span style=\\"color:#24292E;--shiki-dark:#E06C75\\">\\t\\ti</span><span style=\\"color:#D73A49;--shiki-dark:#E5C07B\\"> :=</span><span style=\\"color:#005CC5;--shiki-dark:#D19A66\\"> 0</span><span style=\\"color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic\\"> // Initialize a local variable within the function</span></span>\\n<span class=\\"line\\"><span style=\\"color:#D73A49;--shiki-dark:#C678DD\\">\\t\\treturn</span><span style=\\"color:#D73A49;--shiki-dark:#C678DD\\"> func</span><span style=\\"color:#24292E;--shiki-dark:#ABB2BF\\">() </span><span style=\\"color:#D73A49;--shiki-dark:#C678DD\\">int</span><span style=\\"color:#24292E;--shiki-dark:#ABB2BF\\"> {</span></span>\\n<span class=\\"line\\"><span style=\\"color:#24292E;--shiki-dark:#E06C75\\">\\t\\t\\ti</span><span style=\\"color:#D73A49;--shiki-dark:#56B6C2\\">++</span><span style=\\"color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic\\"> // Increment the local variable</span></span>\\n<span class=\\"line\\"><span style=\\"color:#D73A49;--shiki-dark:#C678DD\\">\\t\\t\\treturn</span><span style=\\"color:#24292E;--shiki-dark:#E06C75\\"> i</span></span>\\n<span class=\\"line\\"><span style=\\"color:#24292E;--shiki-dark:#ABB2BF\\">\\t\\t}</span></span>\\n<span class=\\"line\\"><span style=\\"color:#24292E;--shiki-dark:#ABB2BF\\">\\t}()</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#24292E;--shiki-dark:#E06C75\\">\\tfmt</span><span style=\\"color:#24292E;--shiki-dark:#ABB2BF\\">.</span><span style=\\"color:#6F42C1;--shiki-dark:#61AFEF\\">Println</span><span style=\\"color:#24292E;--shiki-dark:#ABB2BF\\">(</span><span style=\\"color:#6F42C1;--shiki-dark:#61AFEF\\">count</span><span style=\\"color:#24292E;--shiki-dark:#ABB2BF\\">())</span></span>\\n<span class=\\"line\\"><span style=\\"color:#24292E;--shiki-dark:#E06C75\\">\\tfmt</span><span style=\\"color:#24292E;--shiki-dark:#ABB2BF\\">.</span><span style=\\"color:#6F42C1;--shiki-dark:#61AFEF\\">Println</span><span style=\\"color:#24292E;--shiki-dark:#ABB2BF\\">(</span><span style=\\"color:#6F42C1;--shiki-dark:#61AFEF\\">count</span><span style=\\"color:#24292E;--shiki-dark:#ABB2BF\\">())</span></span>\\n<span class=\\"line\\"><span style=\\"color:#24292E;--shiki-dark:#ABB2BF\\">}</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic\\">// Output</span></span>\\n<span class=\\"line\\"><span style=\\"color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic\\">// 1</span></span>\\n<span class=\\"line\\"><span style=\\"color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic\\">// 2</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div><p>Notice that <code>i</code> is a local variable within the <code>count</code> function. Executing the function twice might lead one to expect the output to be <code>1</code> both times. However, the actual output is <code>1</code> followed by <code>2</code>. The reason is that when assigning the closure to a variable (<code>count</code>), it retains a pointer to <code>i</code>. As a result, <code>i</code> is preserved beyond the function's execution due to escape analysis. <strong>If the function is not assigned to a variable, executing it multiple times will yield consistent results.</strong></p>\\n</div>"}`);export{k as comp,h as data};
